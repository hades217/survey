# Profile Detailsæ˜¾ç¤ºé—®é¢˜ - æœ€ç»ˆä¿®å¤æ–¹æ¡ˆ

## é—®é¢˜æ€»ç»“

ç”¨æˆ·æ³¨å†Œåï¼Œåœ¨Profile Settingsä¸­çœ‹ä¸åˆ°è‡ªå·±çš„æ³¨å†Œä¿¡æ¯ï¼Œè€Œæ˜¯æ˜¾ç¤ºé»˜è®¤çš„"Administrator"ä¿¡æ¯ã€‚

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. åç«¯APIä¿®å¤ (`routes/admin.js`)

**ä¿®å¤å‰ï¼š**

```javascript
// é”™è¯¯ï¼šæ€»æ˜¯è¿”å›ç¬¬ä¸€ä¸ªadminç”¨æˆ·
let adminUser = await User.findOne({ role: 'admin' }).populate('companyId');
```

**ä¿®å¤åï¼š**

```javascript
// æ­£ç¡®ï¼šæ ¹æ®JWT tokenè¿”å›å½“å‰ç™»å½•ç”¨æˆ·
let adminUser = null;

if (req.user.id && req.user.id !== 'admin') {
	// æ³¨å†Œç”¨æˆ·ï¼šä½¿ç”¨JWTä¸­çš„ç”¨æˆ·ID
	adminUser = await User.findById(req.user.id).populate('companyId');
} else {
	// æ—§ç‰ˆadminï¼šä¿æŒå…¼å®¹æ€§
	adminUser = await User.findOne({ role: 'admin' }).populate('companyId');
}
```

### 2. å‰ç«¯Proxyé…ç½®ä¿®å¤ (`client/vite.config.ts`)

ä¿®å¤äº†Dockerç¯å¢ƒä¸­çš„APIä»£ç†é…ç½®ï¼Œç¡®ä¿å‰ç«¯èƒ½æ­£ç¡®è¿æ¥åˆ°åç«¯æœåŠ¡ã€‚

## ğŸ§ª æµ‹è¯•éªŒè¯

### æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

#### æ­¥éª¤1ï¼šæ¸…ç†æµ‹è¯•ç¯å¢ƒ

```bash
# ç¡®ä¿ä½¿ç”¨æœ€æ–°çš„ä»£ç 
docker-compose down
docker-compose up -d
```

#### æ­¥éª¤2ï¼šæ³¨å†Œæ–°ç”¨æˆ·

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080/admin/register
2. å¡«å†™æ³¨å†Œä¿¡æ¯ï¼š
    ```
    å§“å: å¼ æµ‹è¯•
    é‚®ç®±: test123@example.com
    å¯†ç : password123
    å…¬å¸: æµ‹è¯•å…¬å¸
    ```
3. ç‚¹å‡»"Create Account"

#### æ­¥éª¤3ï¼šéªŒè¯Profileæ˜¾ç¤º

1. æ³¨å†ŒæˆåŠŸåï¼Œå¦‚æœè·³è½¬åˆ°onboardingï¼Œå¯ä»¥å®Œæˆæˆ–è·³è¿‡
2. è¿›å…¥ç®¡ç†åå°åï¼Œç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·å¤´åƒ
3. é€‰æ‹©"Profile Settings"æˆ–ç›´æ¥è®¿é—®ï¼šhttp://localhost:8080/admin/profile
4. åœ¨"Profile Details"éƒ¨åˆ†æ£€æŸ¥ï¼š

**âœ… ä¿®å¤ååº”è¯¥çœ‹åˆ°ï¼š**

- Name: `å¼ æµ‹è¯•` (ä½ åˆšæ‰æ³¨å†Œçš„åå­—)
- Email: `test123@example.com` (ä½ åˆšæ‰æ³¨å†Œçš„é‚®ç®±)
- Avatar URL: (ç©ºç™½ï¼Œè¿™æ˜¯æ­£å¸¸çš„)

**âŒ ä¿®å¤å‰ä¼šé”™è¯¯æ˜¾ç¤ºï¼š**

- Name: `Administrator`
- Email: `admin@example.com`

#### æ­¥éª¤4ï¼šéªŒè¯ç”¨æˆ·éš”ç¦»

1. æ‰“å¼€æ–°çš„éšç§æµè§ˆçª—å£
2. æ³¨å†Œå¦ä¸€ä¸ªç”¨æˆ·ï¼š
    ```
    å§“å: ææµ‹è¯•
    é‚®ç®±: test456@example.com
    å¯†ç : password456
    å…¬å¸: å¦ä¸€ä¸ªå…¬å¸
    ```
3. æŸ¥çœ‹ç¬¬äºŒä¸ªç”¨æˆ·çš„Profileï¼Œåº”è¯¥æ˜¾ç¤º"ææµ‹è¯•"çš„ä¿¡æ¯
4. å›åˆ°ç¬¬ä¸€ä¸ªçª—å£åˆ·æ–°ï¼Œåº”è¯¥ä»ç„¶æ˜¾ç¤º"å¼ æµ‹è¯•"çš„ä¿¡æ¯

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ä¿®å¤åŸç†

1. **æ³¨å†Œæ—¶**ï¼šJWT tokenåŒ…å«ç”¨æˆ·çš„å®é™…ID
2. **ProfileåŠ è½½æ—¶**ï¼šåç«¯ä½¿ç”¨JWTä¸­çš„IDæŸ¥æ‰¾å…·ä½“ç”¨æˆ·
3. **å‰ç«¯æ˜¾ç¤º**ï¼šæ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„ç”¨æˆ·ä¿¡æ¯è€Œä¸æ˜¯é»˜è®¤ä¿¡æ¯

### ç›¸å…³ç»„ä»¶

- `routes/admin.js` - åç«¯Profile API
- `client/src/contexts/AdminContext.tsx` - Profileæ•°æ®ç®¡ç†
- `client/src/components/AdminDashboard.tsx` - Profileé¡µé¢UI

### JWT Tokenå†…å®¹ç¤ºä¾‹

```json
{
	"id": "68902dedd70f6eeddd1f329d",
	"email": "test123@example.com",
	"role": "admin",
	"iat": 1754279405,
	"exp": 1754884205
}
```

## ğŸ¯ é¢„æœŸç»“æœ

ä¿®å¤å®Œæˆåï¼š

- âœ… æ¯ä¸ªç”¨æˆ·çœ‹åˆ°è‡ªå·±çš„æ³¨å†Œä¿¡æ¯
- âœ… ä¸åŒç”¨æˆ·ä¹‹é—´ä¿¡æ¯éš”ç¦»æ­£ç¡®
- âœ… æ”¯æŒå¤šä¸ªæ³¨å†Œç”¨æˆ·åŒæ—¶ä½¿ç”¨
- âœ… ä¿æŒä¸æ—§ç‰ˆadminè´¦æˆ·çš„å…¼å®¹æ€§

## ğŸš€ éƒ¨ç½²çŠ¶æ€

- âœ… åç«¯ä»£ç ä¿®å¤å®Œæˆ
- âœ… å‰ç«¯ä»£ç†é…ç½®ä¿®å¤å®Œæˆ
- âœ… Dockerå®¹å™¨å·²é‡å»º
- ğŸ“‹ æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤å·²æä¾›

## ğŸ“ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

å¦‚æœæŒ‰ç…§æ­¥éª¤æµ‹è¯•åé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æ£€æŸ¥ï¼š

1. **å®¹å™¨çŠ¶æ€**ï¼šç¡®ä¿æ‰€æœ‰å®¹å™¨éƒ½åœ¨è¿è¡Œ

    ```bash
    docker-compose ps
    ```

2. **åç«¯æ—¥å¿—**ï¼šæ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯

    ```bash
    docker-compose logs backend
    ```

3. **å‰ç«¯æ§åˆ¶å°**ï¼šæ‰“å¼€æµè§ˆå™¨F12æ£€æŸ¥Networkå’ŒConsoleæ ‡ç­¾é¡µ

4. **é‡æ–°æ„å»º**ï¼šå¦‚æœå¿…è¦ï¼Œå®Œå…¨é‡å»ºå®¹å™¨
    ```bash
    docker-compose down
    docker-compose build
    docker-compose up -d
    ```

ç°åœ¨Profile Detailsåº”è¯¥èƒ½æ­£ç¡®æ˜¾ç¤ºæ¯ä¸ªç”¨æˆ·æ³¨å†Œæ—¶å¡«å†™çš„ä¿¡æ¯äº†ï¼ğŸ‰
